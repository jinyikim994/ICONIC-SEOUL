<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ICONIC CREATIVE STUDIO</title>
  <!-- css -->
	<link rel="stylesheet" href="./css/common.css">
  <link rel="stylesheet" href="./css/page/main/main.css">
  <!-- js -->
  <script defer src="./js/common.js"></script>
</head>
<body>
  <!-- main -->
  <div id="main">
    <!-- header -->
    <header id="main-header">
      <h1 class="logo"><a href="./index.html">ICONIC CREATIVE STUDIO</a></h1>
      <button class="mobile-btn" onclick="toggleMenu()">
        <span></span>
        <span></span>
      </button>
      <nav id="navMenu" class="accordion-menu">
        <a href="./artist/artist_list.html">ARTISTS</a>
        <a href="./models/models.html">MODELS</a>
        <a href="./about/about.html">ABOUT</a>
        <a href="./contact/contact.html">CONTACT</a>
      </nav>
    </header>
    <!-- //header -->

    <!-- gallery -->
    <div class="gallery">
      <div class="column column-1"><div class="scroller"></div></div>
      <div class="column column-2"><div class="scroller"></div></div>
      <div class="column column-3"><div class="scroller"></div></div>
    </div>
    <!-- gallery -->
  </div>
  <!-- // main -->

  <script>
  function renderScroller(columnClass, items) {
    const scroller = document.querySelector(`#main .${columnClass} .scroller`);
    const allItems = [...items, ...items]; // 무한 스크롤용으로 2번 반복

    allItems.forEach(item => {
      const wrapper = document.createElement('div');
      wrapper.classList.add('masonry-item');

      if (item.type === "img") {
        const img = document.createElement('img');
        img.src = item.src;
        img.alt = item.alt || "";
        wrapper.appendChild(img);
      } else if (item.type === "video") {
        const video = document.createElement('video');
        video.autoplay = true;
        video.loop = true;
        video.muted = true;
        video.playsInline = true;
        video.setAttribute("decoding", "async");
        video.removeAttribute("controls"); // ✅ 재생 버튼 안 뜨게 하기

        const source = document.createElement('source');
        source.src = item.src;
        source.type = "video/webm";

        video.appendChild(source);
        wrapper.appendChild(video);
      }
      scroller.appendChild(wrapper);
    });
  }

  renderScroller('column-1', column1Content);
  renderScroller('column-2', column2Content);
  renderScroller('column-3', column3Content);

  // ✅ 사용자 첫 터치 시 모든 비디오 강제 재생
  document.addEventListener('DOMContentLoaded', () => {
    document.body.addEventListener('touchstart', () => {
      document.querySelectorAll('video').forEach(video => {
        const playPromise = video.play();
        if (playPromise !== undefined) {
          playPromise.catch(err => {
            console.warn('Video play failed:', err);
          });
        }
      });
    }, { once: true }); // 한 번만 실행
  });
  </script>
</body>
</html>
